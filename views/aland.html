<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SolidRoots Properties - Land Details</title>
    <link
      rel="shortcut icon"
      href="/assets/logo/solidroots properties logo c3-2.png"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background-color: #f5f5f5;
        color: #333;
      }

      .navbar-custom {
        background-color: #124824;
        padding: 1rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .navbar-brand img {
        height: 80px;
      }

      .navbar-dark .navbar-nav .nav-link {
        color: rgba(255, 255, 255, 0.85);
        font-size: 1rem;
        font-weight: 500;
        margin: 5px 15px;
        padding: 5px 10px;
        transition: all 0.3s ease;
      }

      .navbar-dark .navbar-nav .nav-link:hover {
        color: #fff;
        background-color: #b78509;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }

      h1 {
        color: #124824;
        font-weight: bold;
      }

      .btn-primary {
        background-color: #b78509;
        border: none;
      }

      .btn-primary:hover {
        background-color: #124824;
        color: #fff;
      }

      .btn-secondary {
        background-color: #124824;
        color: #fff;
      }

      .btn-secondary:hover {
        background-color: #b78509;
        color: #fff;
      }

      .table {
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
      }

      .table thead {
        background-color: #124824;
        color: #fff;
        border-radius: 10px;
      }

      .table img {
        border-radius: 5px;
      }

      form {
        background-color: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
      }

      label {
        color: #124824;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom">
      <div class="container">
        <a class="navbar-brand" href="dashboard.html">
          <img
            src="https://i.pinimg.com/736x/30/bd/b7/30bdb7888e4126d0638d9c274417faac.jpg"
            alt="SolidRoots Properties"
          />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="table.html"><i class="fas fa-map"></i> Land Properties</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"><i class="fas fa-building"></i> Commercial Properties</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"><i class="fas fa-home"></i> Residential Sales</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"><i class="fas fa-door-open"></i> Residential Lettings</a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle active"
                href="#"
                id="userDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="fas fa-user-circle"></i> Profile
              </a>
              <ul
                class="dropdown-menu dropdown-menu-end"
                aria-labelledby="userDropdown"
              >
                <li>
                  <a class="dropdown-item" href="admin.html"><i class="fas fa-user-cog"></i> Profile Management</a>
                </li>
                <li><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container mt-5">
      <h1 class="text-center mb-4">Manage Land Properties</h1>
      <form id="propertyForm" class="border p-4 bg-light rounded mb-4">
        <h5 class="mb-3 text-center">Add Property</h5>
        <div class="row">
          <!-- Property Name -->
          <div class="col-md-6 mb-3">
            <label for="propertyName" class="form-label">Property Name</label>
            <input type="text" class="form-control" id="propertyName" placeholder="Enter property name" required>
          </div>
      
          <!-- Location -->
          <div class="col-md-6 mb-3">
            <label for="location" class="form-label">Location</label>
            <input type="text" class="form-control" id="location" placeholder="Enter location" required>
          </div>
      
          <!-- Price -->
          <div class="col-md-6 mb-3">
            <label for="price" class="form-label">Price</label>
            <input type="text" class="form-control" id="price" placeholder="Enter price" required>
          </div>
      
          <!-- Property Type -->
          <div class="col-md-6 mb-3">
            <label for="type" class="form-label">Property Type</label>
            <select class="form-select" id="type" required>
              <option value="">Select type</option>
              <option value="apartment">Apartment</option>
              <option value="house">House</option>
              <option value="commercial">Commercial</option>
            </select>
          </div>
      
          <!-- Status -->
          <div class="col-md-6 mb-3">
            <label for="status" class="form-label">Status</label>
            <select class="form-select" id="status" required>
              <option value="available">Available</option>
              <option value="not-available">Not Available</option>
            </select>
          </div>
      
          <!-- Agent Details -->
          <div class="col-md-6 mb-3">
            <label for="agent" class="form-label">Agent Details</label>
            <input type="text" class="form-control" id="agent" placeholder="Enter agent name and contact">
          </div>
      
          <!-- Amenities -->
          <div class="col-md-12 mb-3">
            <label for="amenities" class="form-label">Amenities</label>
            <input type="text" class="form-control" id="amenities" placeholder="Enter amenities (comma-separated)">
          </div>
      
          <!-- Description -->
          <div class="col-md-12 mb-3">
            <label for="description" class="form-label">Description</label>
            <textarea class="form-control" id="description" rows="3" placeholder="Enter a brief description"></textarea>
          </div>
      
          <!-- Property Image -->
          <div class="col-md-12 mb-3">
            <label for="image" class="form-label">Property Image</label>
            <input type="file" class="form-control" id="image" accept="image/*">
          </div>
        </div>
      
        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary w-100">Add Property</button>
      </form>
      
      <!-- Bootstrap JS and dependencies (optional) -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
      

      <div class="table-responsive">
        <table id="propertyTable" class="table table-hover table-bordered">
          <thead class="table-dark">
            <tr>
              <th onclick="sortTable(0)">Property Name</th>
              <th onclick="sortTable(1)">Location</th>
              <th onclick="sortTable(2)">Price</th>
              <th>Type</th>
              <th>Status</th>
              <th>Agent</th>
              <th>Description</th>
              <th>Amenities</th>
              <th>Image</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="propertyTableBody">
            <!-- Dynamic Rows -->
          </tbody>
        </table>
      </div>
    </div>

    <script>
      const apiUrl = "https://srpropertiesbackend.vercel.app/api/lands"; // Replace with your backend endpoint

      // Fetch and display land properties
      const fetchLands = async () => {
        try {
          const response = await axios.get(apiUrl);
          const lands = response.data;
          const tableBody = document.getElementById("landTable");
          tableBody.innerHTML = "";

          lands.forEach((land) => {
            const row = `<tr>
                        <td>${land.location}</td>
                        <td>${land.price}</td>
                        <td>${land.category}</td>
                        <td>${land.status}</td>
                        <td>${land.availability}</td>
                        <td>${land.amenities}</td>
                        <td>${land.description}</td>
                        <td>
                            ${land.images
                              .map(
                                (image) =>
                                  `<img src="${image}" alt="Land Image" class="img-thumbnail" style="width: 100px; height: 100px;">`
                              )
                              .join("")}
                        </td>
                        <td>
                            <button class="btn btn-sm btn-warning" onclick="editLand('${
                              land._id
                            }')">Edit</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteLand('${
                              land._id
                            }')">Delete</button>
                        </td>
                    </tr>`;
            tableBody.innerHTML += row;
          });
        } catch (error) {
          console.error("Error fetching land properties:", error);
        }
      };

      // Add or update land
      document
        .getElementById("landForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const landId = document.getElementById("landId").value;
          const landData = {
            location: document.getElementById("location").value,
            price: document.getElementById("price").value,
            category: document.getElementById("category").value,
            status: document.getElementById("status").value,
            availability: document.getElementById("availability").value,
            amenities: document.getElementById("amenities").value,
            description: document.getElementById("description").value,
            images: [...document.getElementById("images").files],
          };

          try {
            if (landId) {
              await axios.put(`${apiUrl}/${landId}`, landData);
            } else {
              await axios.post(apiUrl, landData);
            }

            document.getElementById("landForm").reset();
            fetchLands();
          } catch (error) {
            console.error("Error saving land:", error);
          }
        });

      // Edit land
      const editLand = async (id) => {
        try {
          const response = await axios.get(`${apiUrl}/${id}`);
          const land = response.data;

          document.getElementById("landId").value = land._id;
          document.getElementById("location").value = land.location;
          document.getElementById("price").value = land.price;
          document.getElementById("category").value = land.category;
          document.getElementById("status").value = land.status;
          document.getElementById("availability").value = land.availability;
          document.getElementById("amenities").value = land.amenities;
          document.getElementById("description").value = land.description;
        } catch (error) {
          console.error("Error fetching land data for editing:", error);
        }
      };

      // Delete land
      const deleteLand = async (id) => {
        try {
          if (confirm("Are you sure you want to delete this land?")) {
            await axios.delete(`${apiUrl}/${id}`);
            fetchLands();
          }
        } catch (error) {
          console.error("Error deleting land:", error);
        }
      };

      // Reset form
      document.getElementById("resetForm").addEventListener("click", () => {
        document.getElementById("landForm").reset();
        document.getElementById("landId").value = "";
      });

      fetchLands();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js"></script>
  </body>
</html>
